<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ryder Cup 2025 Fantasy League</title>
    <style>
        /* CSS Styling */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 0;
        }
        #app {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        h1 {
            text-align: center;
            color: #00468C; /* USA Blue */
            border-bottom: 3px solid #FFCD00; /* Europe Yellow */
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .section-title {
            color: #1A3E5C;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        /* Login and Setup Form */
        #login-screen, #setup-screen {
            text-align: center;
            padding: 40px 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        .form-control {
            margin-bottom: 15px;
        }
        .form-control label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-control input, .form-control select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .submit-btn {
            background-color: #00468C;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
        }
        .submit-btn:hover {
            background-color: #003366;
        }

        /* Leaderboard */
        #leaderboard table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        #leaderboard th, #leaderboard td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        #leaderboard th {
            background-color: #f0f0f0;
            color: #333;
            font-weight: bold;
        }
        #leaderboard tr:nth-child(even) {
            background-color: #fafafa;
        }
        .overall-winner-pick {
            font-weight: bold;
        }
        .usa-color { color: #00468C; }
        .eur-color { color: #FFCD00; }

        /* Team Roster View */
        .player-list {
            list-style: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .player-item {
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: bold;
            flex: 1 1 45%; /* Allows 2 per row */
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .player-usa { border: 1px solid #00468C; background-color: #e6f0ff; }
        .player-eur { border: 1px solid #FFCD00; background-color: #fffbe6; }

        /* Admin/Match Input (Hidden by default) */
        #admin-panel {
            background-color: #eafaea;
            border: 1px solid #ccc;
            padding: 20px;
            margin-top: 30px;
            border-radius: 6px;
        }
        #admin-panel label {
            font-weight: bold;
        }
        .admin-result-input {
            margin-bottom: 10px;
        }
        .player-select {
            padding: 5px;
            margin: 5px;
        }
        .hide {
            display: none !important;
        }
    </style>
</head>
<body>

    <div id="app">
        <h1>Ryder Cup 2025 Fantasy League</h1>
        
        <div id="login-screen">
            <h2 class="section-title">Welcome to the Fantasy League!</h2>
            <div class="form-control">
                <label for="login-name">Your Login Name (e.g., Mike, Sarah):</label>
                <input type="text" id="login-name" placeholder="Enter your name" required>
            </div>
            <div class="form-control">
                <label for="league-code">League Code:</label>
                <input type="password" id="league-code" placeholder="Enter the secret code" required>
            </div>
            <button class="submit-btn" onclick="handleLogin()">Login / Join League</button>
            <p id="login-error" style="color: red; margin-top: 10px;"></p>
        </div>

        <div id="setup-screen" class="hide">
            <h2 class="section-title">Team Setup: <span id="setup-user-name"></span></h2>
            
            <div class="form-control">
                <label for="overall-pick">Overall Winner Pick (Bonus +15 Points):</label>
                <select id="overall-pick" required>
                    <option value="">-- Select Winner --</option>
                    <option value="USA">USA</option>
                    <option value="EUR">Europe</option>
                </select>
            </div>

            <div class="form-control">
                <label>Select Your 5 Players (Any mix, max 5 total):</label>
                <div id="player-selection-list" style="max-height: 250px; overflow-y: auto; text-align: left; border: 1px solid #ddd; padding: 10px; border-radius: 4px;">
                    </div>
            </div>

            <div class="form-control">
                <label for="day-winner-friday">Friday Day Winner (Double Points):</label>
                <select id="day-winner-friday" required>
                    </select>
            </div>
            <div class="form-control">
                <label for="day-winner-saturday">Saturday Day Winner (Double Points):</label>
                <select id="day-winner-saturday" required>
                    </select>
            </div>
            <div class="form-control">
                <label for="day-winner-sunday">Sunday Day Winner (Double Points):</label>
                <select id="day-winner-sunday" required>
                    </select>
            </div>
            
            <button class="submit-btn" onclick="saveTeamSetup()">Lock In My Team</button>
            <p id="setup-error" style="color: red; margin-top: 10px;"></p>
        </div>

        <div id="main-view" class="hide">
            <h2 class="section-title">Current Standings</h2>
            <div id="leaderboard">
                </div>
            
            <h2 class="section-title">My Team (<span id="my-team-name"></span> - Pick: <span id="my-overall-pick" class="overall-winner-pick"></span>)</h2>
            <ul id="my-roster-list" class="player-list">
                </ul>

            <h2 class="section-title">Day Winner Selections</h2>
            <p><strong>Friday:</strong> <span id="day-winner-friday-display"></span></p>
            <p><strong>Saturday:</strong> <span id="day-winner-saturday-display"></span></p>
            <p><strong>Sunday:</strong> <span id="day-winner-sunday-display"></span></p>
        </div>

        <div id="admin-panel" class="hide">
            <h2 class="section-title" style="color: #c0392b;">Commissioner Panel (Admin)</h2>
            <button class="submit-btn" style="background-color: #2c3e50;" onclick="showHideAdmin()">Toggle Admin Input</button>
            
            <div id="admin-input-area" class="hide" style="padding: 10px; border-top: 1px solid #ccc; margin-top: 10px;">
                <h3 style="margin-top: 0;">Enter Match Result</h3>
                
                <div class="form-control">
                    <label for="match-day-select">Day:</label>
                    <select id="match-day-select">
                        <option value="Friday">Friday</option>
                        <option value="Saturday">Saturday</option>
                        <option value="Sunday">Sunday</option>
                    </select>
                </div>
                
                <div class="form-control">
                    <label for="match-winner-select">Winning Team:</label>
                    <select id="match-winner-select">
                        <option value="USA">USA</option>
                        <option value="EUR">Europe</option>
                        <option value="TIE">Halve (Tie)</option>
                    </select>
                </div>
                
                <div class="form-control">
                    <label for="match-margin-select">Result Margin (for Decisive Bonus):</label>
                    <select id="match-margin-select">
                        <option value="4&3+">4&amp;3 or greater (Decisive +1pt)</option>
                        <option value="standard">Standard (e.g., 1UP, 2&amp;1, Halve)</option>
                    </select>
                </div>

                <div class="form-control">
                    <label>Players Involved (Input all 4/2 players):</label>
                    <p style="font-size: 0.8em; color: #555;">Use player IDs from the `fantasy_data.js` file (e.g., 'sscheffler'). Separate IDs with commas.</p>
                    <textarea id="player-ids-input" rows="3" style="width: 100%;" placeholder="e.g., sscheffler, xschauffele, rmcilroy, jrahm"></textarea>
                </div>

                <div class="form-control">
                    <label for="total-birdies-input">Total Birdies/Eagles for Match (Sum of all 4/2 players):</label>
                    <input type="number" id="total-birdies-input" value="0" min="0">
                </div>
                
                <button class="submit-btn" style="background-color: #c0392b;" onclick="submitMatchResult()">Submit Match Result & Update Scores</button>

                <h3 style="margin-top: 20px;">Final Overall Winner</h3>
                <div class="form-control">
                    <label for="final-winner-select">Ryder Cup Winner:</label>
                    <select id="final-winner-select">
                        <option value="">-- Not Decided --</option>
                        <option value="USA">USA</option>
                        <option value="EUR">Europe</option>
                    </select>
                </div>
                <button class="submit-btn" style="background-color: green;" onclick="setOverallWinner()">Finalize Winner & Award Bonus</button>
            </div>
        </div>

    </div>

    <script src="fantasy_data.js"></script>
    <script>
        // --- Global Variables (Simulating Storage) ---
        // In a real deployed app, this would be an AJAX call to load the JSON file.
        // For this demo, we use the variables defined in fantasy_data.js
        
        let currentUserName = null;
        const COMMISSIONER_CODE = LEAGUE_DATA.leagueCode + '-ADMIN'; // A secret admin code

        // --- Utility Functions ---
        
        /** Simulates saving/loading the LEAGUE_DATA object to "storage" (localStorage) */
        function saveData() {
            localStorage.setItem('fantasyLeagueData', JSON.stringify(LEAGUE_DATA));
        }

        function loadData() {
            const savedData = localStorage.getItem('fantasyLeagueData');
            if (savedData) {
                // Merge loaded data over the initial structure
                Object.assign(LEAGUE_DATA, JSON.parse(savedData));
                
                // Re-initialize playerScores in case a new player was added to PLAYERS array
                for (const player of PLAYERS) {
                    if (!LEAGUE_DATA.playerScores[player.id]) {
                        LEAGUE_DATA.playerScores[player.id] = { total: 0, Friday: 0, Saturday: 0, Sunday: 0, birdies: 0 };
                    }
                }
            }
        }
        
        /** Gets a player object by their ID */
        function getPlayerById(id) {
            return PLAYERS.find(p => p.id === id);
        }

        // -- (The rest of your JavaScript functions will follow here)
    </script>
</body>
</html>
